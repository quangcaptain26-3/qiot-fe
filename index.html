<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoT LED Matrix Control</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>üåê IoT LED Matrix Control</h1>
            <p class="subtitle">ƒêi·ªÅu khi·ªÉn ESP8266 + MAX7219 qua MQTT</p>
        </header>

        <div class="status-bar">
            <div class="status-item">
                <span class="status-label">MQTT:</span>
                <span id="mqttStatus" class="status-value disconnected">Disconnected</span>
            </div>
            <div class="status-item">
                <span class="status-label">Server:</span>
                <span id="serverStatus" class="status-value">Checking...</span>
            </div>
        </div>

        <main>
            <!-- Section 1: Weather Control -->
            <section class="card">
                <h2>üå§Ô∏è Th·ªùi Ti·∫øt</h2>
                <div class="form-group">
                    <label for="latitude">Vƒ© ƒë·ªô (Latitude):</label>
                    <input type="number" id="latitude" step="0.000001" value="10.762622" placeholder="10.762622">
                </div>
                <div class="form-group">
                    <label for="longitude">Kinh ƒë·ªô (Longitude):</label>
                    <input type="number" id="longitude" step="0.000001" value="106.660172" placeholder="106.660172">
                </div>
                <button id="updateLocationBtn" class="btn btn-primary">C·∫≠p nh·∫≠t v·ªã tr√≠</button>

                <div id="weatherDisplay" class="data-display">
                    <p class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</p>
                </div>
            </section>

            <!-- Section 2: Exchange Rate -->
            <section class="card">
                <h2>üí± T·ªâ Gi√°</h2>
                <div class="form-group-row">
                    <div class="form-group">
                        <label for="baseCurrency">Ti·ªÅn t·ªá g·ªëc (From):</label>
                        <select id="baseCurrency"></select>
                    </div>
                    <div class="form-group">
                        <label for="targetCurrency">Ti·ªÅn t·ªá ƒë√≠ch (To):</label>
                        <select id="targetCurrency"></select>
                    </div>
                </div>
                <div class="button-group">
                    <button id="refreshExchangeBtn" class="btn btn-secondary">L√†m m·ªõi t·ª∑ gi√°</button>
                    <button id="displayExchangeBtn" class="btn btn-primary">Hi·ªÉn th·ªã l√™n LED</button>
                </div>
                <div id="exchangeDisplay" class="data-display">
                    <p class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</p>
                </div>
            </section>

            <!-- Section 3: Auto Display -->
            <section class="card highlight-card">
                <h2>üîÑ Ch·∫ø ƒê·ªô T·ª± ƒê·ªông</h2>
                <p class="subtitle">T·ª± ƒë·ªông hi·ªÉn th·ªã: Th·ªùi gian ‚Üí Th·ªùi ti·∫øt ‚Üí T·∫•t c·∫£ t·ª∑ gi√°</p>
                <div class="button-group">
                    <button id="autoDisplayBtn" class="btn btn-success btn-large">‚ñ∂Ô∏è B·∫Øt ƒë·∫ßu AUTO</button>
                    <button id="stopAutoBtn" class="btn btn-danger btn-large" disabled>‚èπÔ∏è D·ª´ng AUTO</button>
                </div>
                <div id="autoStatus" class="auto-status">
                    <span class="status-label">Tr·∫°ng th√°i:</span>
                    <span id="autoStatusText" class="status-value">Ch∆∞a ch·∫°y</span>
                </div>
            </section>

            <!-- Section 4: Custom Message -->
            <section class="card">
                <h2>‚úâÔ∏è Custom Message</h2>
                <div class="form-group">
                    <label for="customMessage">Nh·∫≠p message:</label>
                    <input type="text" id="customMessage" placeholder="Nh·∫≠p text ƒë·ªÉ hi·ªÉn th·ªã tr√™n LED...">
                </div>
                <div class="form-group">
                    <label for="messageMode">Ch·∫ø ƒë·ªô:</label>
                    <select id="messageMode">
                        <option value="">M·∫∑c ƒë·ªãnh</option>
                        <option value="scroll_left">Scroll Tr√°i</option>
                        <option value="scroll_right">Scroll Ph·∫£i</option>
                        <option value="blink">Blink</option>
                    </select>
                </div>
                <button id="sendMessageBtn" class="btn btn-primary">G·ª≠i Message</button>
            </section>

            <!-- Section 5: LED Settings -->
            <section class="card">
                <h2>‚öôÔ∏è C√†i ƒê·∫∑t LED</h2>

                <!-- T·ªëc ƒë·ªô cu·ªôn -->
                <div class="setting-group">
                    <h3>üèÉ T·ªëc ƒê·ªô Cu·ªôn</h3>
                    <div class="form-group">
                        <label for="ledSpeed">ƒêi·ªÅu ch·ªânh t·ªëc ƒë·ªô:</label>
                        <div class="speed-control">
                            <span class="speed-label">Ch·∫≠m</span>
                            <input type="range" id="ledSpeed" min="0" max="100" value="50">
                            <span class="speed-label">Nhanh</span>
                        </div>
                        <div class="speed-display">
                            <span>Gi√° tr·ªã hi·ªán t·∫°i: <strong id="speedValue">50</strong></span>
                        </div>
                    </div>
                    <button id="applySpeedBtn" class="btn btn-primary">‚úì √Åp d·ª•ng t·ªëc ƒë·ªô</button>
                </div>

                <!-- ƒê·ªô s√°ng -->
                <div class="setting-group">
                    <h3>üí° ƒê·ªô S√°ng</h3>
                    <div class="form-group">
                        <label for="ledBrightness">ƒêi·ªÅu ch·ªânh ƒë·ªô s√°ng:</label>
                        <div class="brightness-control">
                            <span class="brightness-label">T·ªëi</span>
                            <input type="range" id="ledBrightness" min="1" max="15" value="8">
                            <span class="brightness-label">S√°ng</span>
                        </div>
                        <div class="brightness-display">
                            <span>Gi√° tr·ªã hi·ªán t·∫°i: <strong id="brightnessValue">8</strong></span>
                        </div>
                    </div>
                    <button id="applyBrightnessBtn" class="btn btn-primary">‚úì √Åp d·ª•ng ƒë·ªô s√°ng</button>
                </div>

                <!-- Ch·∫ø ƒë·ªô hi·ªÉn th·ªã -->
                <div class="setting-group">
                    <h3>üé≠ Ch·∫ø ƒê·ªô Hi·ªÉn Th·ªã</h3>
                    <div class="form-group">
                        <label for="ledMode">Ch·ªçn ch·∫ø ƒë·ªô:</label>
                        <select id="ledMode">
                            <option value="">Kh√¥ng ƒë·ªïi</option>
                            <option value="scroll_left">Scroll Tr√°i</option>
                            <option value="scroll_right">Scroll Ph·∫£i</option>
                            <option value="blink">Blink</option>
                        </select>
                    </div>
                    <button id="applyModeBtn" class="btn btn-primary">‚úì √Åp d·ª•ng ch·∫ø ƒë·ªô</button>
                </div>
            </section>
        </main>

        <section class="card">
            <h2>üìä L·ªãch S·ª≠ D·ªØ Li·ªáu</h2>
            <p class="subtitle">T√≠nh to√°n gi√° tr·ªã trung b√¨nh trong kho·∫£ng th·ªùi gian ƒë√£ qua.</p>

            <!-- Weather History -->
            <div class="history-group">
                <h3>üå§Ô∏è L·ªãch s·ª≠ Th·ªùi ti·∫øt</h3>
                <div class="form-group">
                    <label for="weatherHistoryMinutes">Nh·∫≠p s·ªë ph√∫t (t√≠nh t·ª´ b√¢y gi·ªù):</label>
                    <input type="number" id="weatherHistoryMinutes" min="1" placeholder="V√≠ d·ª•: 60">
                </div>
                <button id="calculateWeatherHistoryBtn" class="btn btn-secondary">T√≠nh trung b√¨nh</button>
                <div id="weatherHistoryResult" class="data-display" style="display:none;"></div>
            </div>

            <!-- Exchange Rate History -->
            <div class="history-group">
                <h3>üí± L·ªãch s·ª≠ T·ªâ Gi√°</h3>
                <div class="form-group">
                    <label for="exchangeHistoryMinutes">Nh·∫≠p s·ªë ph√∫t (t√≠nh t·ª´ b√¢y gi·ªù):</label>
                    <input type="number" id="exchangeHistoryMinutes" min="1" placeholder="V√≠ d·ª•: 60">
                </div>
                <button id="calculateExchangeHistoryBtn" class="btn btn-secondary">T√≠nh trung b√¨nh</button>
                <div id="exchangeHistoryResult" class="data-display" style="display:none;"></div>
            </div>
        </section>

        <footer>
            <a href="logs.html" class="btn btn-link">üìä Xem Logs</a>
        </footer>
    </div>

    <!-- MQTT.js library for WebSocket connection -->
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
    <script type="module" src="app.js"></script>
</body>

</html>